<style type="text/css">
    .controls {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        column-gap: 8px;
    }

    .users-row {
        pointer-events: none;
    }
</style>

{{>user-list}}

<div class="user-info">
    <input name="pristineName" type="text" value="{{this.user.name}}" hidden>
    <input name="pristinePhone" type="text" value="{{this.user.phone_number}}" hidden>
    <input
        type="text"
        name="name"
        value="{{this.user.name}}"
        form="update"
        oninput="formValueChangeHandler()"
    >
    <input
        type="text"
        name="phone_number"
        value="{{this.user.phone_number}}"
        form="update"
        oninput="formValueChangeHandler()"
    >
</div>

<div class="controls">
    <form id="update" action="/users/update" method="POST">
        <input type="number" name="id" value="{{this.user.id}}" hidden>
        <button type="submit">Изменить</button>
    </form>
    <form action="/users/delete" method="POST">
        <input type="number" name="userId" value="{{this.user.id}}" hidden>
        <button type="submit" id="deleteBtn">Удалить</button>
    </form>
    {{cancelOperation}}
</div>

<script type="text/javascript">
    const deleteBtn = document.getElementById('deleteBtn');
    const pristineName = document.getElementsByName('pristineName')[0].value;
    const pristinePhone = document.getElementsByName('pristinePhone')[0].value;

    function formValueChangeHandler() {
        const name = document.getElementsByName('name')[0].value;
        const phone = document.getElementsByName('phone_number')[0].value;

        if (name !== pristineName || phone !== pristinePhone) {
            deleteBtn.disabled = true;
        } else {
            deleteBtn.disabled = false;
        }
    }
</script>